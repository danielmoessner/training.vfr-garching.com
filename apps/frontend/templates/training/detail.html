{% extends 'base.html' %}

{% block main %}
    <div class="print:hidden" x-data="{ imgModal : false, imgModalSrc : '', imgModalDesc : '' }">
        <template
                @img-modal.window="imgModal = true; imgModalSrc = $event.detail.imgModalSrc; imgModalDesc = $event.detail.imgModalDesc;"
                x-if="imgModal">
            <div x-transition:enter="transition ease-out duration-300"
                 x-transition:enter-start="opacity-0 transform scale-100"
                 x-transition:enter-end="opacity-100 transform scale-100"
                 x-transition:leave="transition ease-in duration-300"
                 x-transition:leave-start="opacity-100 transform scale-100"
                 x-transition:leave-end="opacity-0 transform scale-100" x-on:click.away="imgModalSrc = ''"
                 class="p-2 fixed w-full h-100 inset-0 z-50 overflow-hidden flex justify-center items-center bg-black bg-opacity-75">
                <div @click.away="imgModal = ''" class="flex flex-col max-w-3xl max-h-full overflow-auto">
                    <div class="z-50">
                        <button @click="imgModal = ''" class="float-right pt-2 pr-2 outline-none focus:outline-none">
                            <svg class="fill-current text-white " xmlns="http://www.w3.org/2000/svg" width="18"
                                 height="18" viewBox="0 0 18 18">
                                <path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z">
                                </path>
                            </svg>
                        </button>
                    </div>
                    <div class="p-2">
                        <img :alt="imgModalSrc" class="object-contain h-1/2-screen" :src="imgModalSrc">
                        <p x-text="imgModalDesc" class="text-center text-white"></p>
                    </div>
                </div>
            </div>
        </template>
    </div>
    <main class="{% include 'symbols/main.txt' %}" x-data="trainingsData()" x-init="init()">
        <div class="{% include 'symbols/container.txt' %} lg:w-96 print:hidden">
            {% include 'symbols/sidenav/index.html' %}
        </div>
        <div class="lg:flex-1">
            <div class="{% include 'symbols/container.txt' %}">
                <div class="bg-white border border-gray-300 shadow mb-4 sm:p-0 sm:rounded-lg print:border-none print:shadow-none">
                    <div class="flex flex-col xl:flex-row">
                        <div class="xl:w-1/3 space-y-5" x-data="{ image: '{{ training.image1.url }}', alt: 'Bild 1' }">
                            <div>
                                <img @click="$dispatch('img-modal', {  imgModalSrc: image, imgModalDesc: '' })"
                                     class="mw-full cursor-pointer h-auto sm:rounded-t-lg lg:rounded-tr-none"
                                     :src="image"
                                     :alt="`{{ training.name }} ${alt}`">
                                {% if training.image2 or training.image3 or training.image4 %}
                                    <div class="p-1 print:hidden">
                                        <div class="flex flex-row h-20 space-x-1 overflow-x-scroll md:overflow-auto">
                                            {% include 'symbols/pages/training_detail/image_preview.html' with image=training.image1 alt=training.name|add:' Bild 1' %}
                                            {% include 'symbols/pages/training_detail/image_preview.html' with image=training.image2 alt=training.name|add:' Bild 2' %}
                                            {% include 'symbols/pages/training_detail/image_preview.html' with image=training.image3 alt=training.name|add:' Bild 3' %}
                                            {% include 'symbols/pages/training_detail/image_preview.html' with image=training.image4 alt=training.name|add:' Bild 4' %}
                                        </div>
                                    </div>
                                {% endif %}
                            </div>
                            {% if training.video %}
                                <div class="print:hidden">
                                    <div class="aspect-w-16 aspect-h-9">
                                        <iframe class=""
                                                src="https://www.youtube.com/embed/{{ training.get_video_code }}"
                                                title="YouTube video player" frameborder="0"
                                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                                allowfullscreen></iframe>
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                        <div class="xl:w-2/3 p-4 sm:px-6 sm:py-6">
                            <div class="flex items-center">
                                <h1 class="text-2xl font-medium text-gray-900 mr-4 md:text-3xl md:font-bold">
                                    {{ object.name }}
                                </h1>
                                <abbr class="" title="Lesezeichen setzen">
                                    <a class="block transition p-1 rounded focus:outline-none {% if bookmarked %}text-gray-800 hover:text-gray-500 focus:text-gray-400{% else %}text-gray-400 hover:text-gray-600 focus:text-gray-700{% endif %}"
                                       href="{% url 'training_bookmark' object.pk %}"
                                    >
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none"
                                             viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                  d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"/>
                                        </svg>
                                    </a>
                                </abbr>
                            </div>
                            <div class="flex flex-row mt-2 text-gray-400">
                                {% include 'symbols/stars.html' with training=object %}
                            </div>
                            <div class="flex flex-row mt-3 text-gray-600">
                                <svg class="h-5 w-5 text-gray-400 flex-none"
                                     xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"
                                     fill="currentColor">
                                    <path fill-rule="evenodd"
                                          d="M3 3a1 1 0 011-1h12a1 1 0 011 1v3a1 1 0 01-.293.707L12 11.414V15a1 1 0 01-.293.707l-2 2A1 1 0 018 17v-5.586L3.293 6.707A1 1 0 013 6V3z"
                                          clip-rule="evenodd"></path>
                                </svg>
                                <div class="flex flex-row flex-wrap text-xs -mb-1 space-x-3">
                                    {% for training_filter in training.get_filters %}
                                        <div class="mb-2">{% if forloop.counter != 1 %} | {% endif %}</div>
                                        <div class="mb-2">{{ training_filter.name }}</div>
                                    {% endfor %}
                                </div>
                            </div>
                            <div class="mt-12 md:mt-16">
                                <div class="prose-sm prose md:prose max-w-full md:max-w-full">
                                    {# fix a weird printing issue #}
                                    <style>
                                        @media print {
                                            ul {
                                                padding-left: 20px !important;
                                            }

                                            li {
                                                list-style-type: disc !important;
                                                padding-left: 0px !important;
                                            }

                                            li::before {
                                                display: none !important;
                                            }
                                        }
                                    </style>
                                    {# endfix #}
                                    <h2>Beschreibung</h2>
                                    {{ training.description|safe }}
                                    {% with training_filters=training.get_detail_filters %}
                                        {% if training_filters %}
                                            <h2>Spielprinzipien & Methoden</h2>
                                            {% for filter in training_filters %}
                                                <h3>{{ filter.name }}</h3>
                                                <p>{{ filter.description|linebreaksbr }}</p>
                                            {% endfor %}
                                        {% endif %}
                                    {% endwith %}
                                    <h2>Coachingpunkte</h2>
                                    {{ training.coaching|safe }}
                                    <h2>Variationen</h2>
                                    {{ training.variations|safe }}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    {% include 'symbols/trainings_data.html' %}
{% endblock main %}