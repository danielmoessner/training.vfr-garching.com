{% extends 'base.html' %}

{% load extra_tags %}

{% block main %}
    <div class="print:hidden" x-data="{ imgModal : false, imgModalSrc : '', imgModalDesc : '' }">
        <template
                @img-modal.window="imgModal = true; imgModalSrc = $event.detail.imgModalSrc; imgModalDesc = $event.detail.imgModalDesc;"
                x-if="imgModal">
            <div x-transition:enter="transition ease-out duration-300"
                 x-transition:enter-start="opacity-0 transform scale-100"
                 x-transition:enter-end="opacity-100 transform scale-100"
                 x-transition:leave="transition ease-in duration-300"
                 x-transition:leave-start="opacity-100 transform scale-100"
                 x-transition:leave-end="opacity-0 transform scale-100" x-on:click.away="imgModalSrc = ''"
                 class="p-2 fixed w-full h-100 inset-0 z-50 overflow-hidden flex justify-center items-center bg-black bg-opacity-75">
                <div @click.away="imgModal = ''" class="flex flex-col max-w-3xl max-h-full overflow-auto">
                    <div class="z-50">
                        <button @click="imgModal = ''" class="float-right pt-2 pr-2 outline-none focus:outline-none">
                            <svg class="fill-current text-white " xmlns="http://www.w3.org/2000/svg" width="18"
                                 height="18" viewBox="0 0 18 18">
                                <path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z">
                                </path>
                            </svg>
                        </button>
                    </div>
                    <div class="p-2">
                        <img :alt="imgModalSrc" class="object-contain h-1/2-screen" :src="imgModalSrc">
                        <p x-text="imgModalDesc" class="text-center text-white"></p>
                    </div>
                </div>
            </div>
        </template>
    </div>
    <main class="{% include 'symbols/main.txt' %} print:hidden" x-data="trainingsData()" x-init="init()">
        <div class="{% include 'symbols/container.txt' %} lg:w-80">
            {% include 'symbols/sidenav/index.html' %}
        </div>
        <div class="lg:flex-1">
            <div class="{% include 'symbols/container.txt' %}">
                <div x-cloak class="{% include 'symbols/box/filters_top.txt' %}">
                    <a class="group flex items-center justify-center px-2 py-1 space-x-2 my-3 mx-2 bg-white rounded h-8"
                       href="{% url 'training_list' %}"
                    >
                        <div class="text-gray-400 group-hover:text-gray-500">
                            {% include 'svg/solid-arrow-narrow-left.svg' %}
                        </div>
                        <div class="text-gray-800 group-hover:text-gray-900">
                            Zur√ºck
                        </div>
                    </a>
                    {% include 'symbols/filters/shop.html' %}
                </div>
                {% include 'symbols/exercise_detail.html' with exercise=object %}
            </div>
        </div>
    </main>
    <section class="print:block hidden">
        {# fix a weird printing issue #}
        <style>
            @media print {
                ul {
                    padding-left: 20px !important;
                }

                li {
                    list-style-type: disc !important;
                    padding-left: 0px !important;
                }

                li::before {
                    display: none !important;
                }
            }
        </style>
        {# endfix #}
        <div class="prose max-w-none w-full">
            <h1 style="margin: 0;">{{ object.name }}</h1>
            <p style="margin: 0;">{{ object.focus }}</p>
            <div class="-ml-2">
                <img class="inline w-1/4 float-left p-2" src="{{ object.image1.url }}" alt="Bild 1">
                {% if object.image2 %}
                    <img class="inline w-1/4 float-left p-2" src="{{ object.image2.url }}"
                         alt="Bild 2">
                {% endif %}
                {% if object.image3 %}
                    <img class="inline w-1/4 float-left p-2" src="{{ object.image3.url }}"
                         alt="Bild 3">
                {% endif %}
                {% if object.image4 %}
                    <img class="inline w-1/4 float-left p-2" src="{{ object.image4.url }}"
                         alt="Bild 4">
                {% endif %}
            </div>
            <div class="clear-both"></div>
            <h2 style="margin-top: 0;">Beschreibung</h2>
            {{ object.description|safe }}
            {% with training_filters=object.get_detail_filters %}
                {% if training_filters %}
                    <h2>Spielprinzipien & Methoden</h2>
                    {% for filter in training_filters %}
                        <h3>{{ filter.name }}</h3>
                        <ul>
                            {% for item in filter.description|splitlines %}
                                <li>{{ item }}</li>
                            {% endfor %}
                        </ul>
                    {% endfor %}
                {% endif %}
            {% endwith %}
            <h2>Coachingpunkte</h2>
            {{ object.coaching|safe }}
            {% if object.variations %}
                <h2>Variationen</h2>
                {{ object.variations|safe }}
            {% endif %}
        </div>
    </section>
    {% include 'alpine/trainings.html' %}
{% endblock main %}